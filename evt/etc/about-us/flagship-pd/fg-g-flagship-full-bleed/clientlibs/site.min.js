(function(){var b=window.sg.common.$q,f=window.sg.common.utils,e=window.sg.common.video,h=window.sg.common.libs,k=window.sg.common.utils.setMobileFocusLoop,l=window.sg.common.utils.removeMobileFocusLoop,d=function(a){this.selector={section:".flagship-full-bleed",mediaBox:".flagship-full-bleed__media-wrap",videoEl:".video",videoBtn:".flagship-full-bleed__btn-wrap .js-video-play",videoBtnR:".flagship-full-bleed__play-btn",videoLayer:".flagship-full-bleed__video-layer",videoWrap:".flagship-full-bleed__video",
videoClose:".flagship-full-bleed__close",videoActive:"on"};this.ele={window:b(window),section:b(a)};this.activeVideo=null;this.handler={focusLock:this.focusLock.bind(this)};d.instances.set(a,this);this.init()};d.prototype.init=function(){this.setProperty();this.bindEvents()};d.prototype.reInit=function(){this.init()};d.prototype.setProperty=function(){this.videoBtn=this.ele.section.find(this.selector.videoBtn);this.videoLayer=this.ele.section.find(this.selector.videoLayer);this.videoWrap=this.videoLayer.find(this.selector.videoWrap);
this.videoClose=this.videoLayer.find(this.selector.videoClose);this.mediaBox=this.ele.section.find(this.selector.mediaBox)};d.prototype.setSubProperty=function(){this.videoMediaBtn=this.mediaBox.find(this.selector.videoBtnR);this.videoMediaWrap=this.mediaBox.find(this.selector.videoWrap);this.videoMediaClose=this.mediaBox.find(this.selector.videoClose);var a=this.videoMediaWrap.find(this.selector.videoEl).attr("data-video-embed");0<this.videoMediaBtn.target.length&&("true"===a?this.videoMediaBtn.attr("aria-hidden",
!0):this.videoMediaBtn.removeAttr("aria-hidden"))};d.prototype.activeEmbed=function(a){var c=a.find(this.selector.videoEl).target[0];e.init(c);e.play(c);b(c).attr("tabindex",0);setTimeout(function(){b(c).focus()},500)};d.prototype.deActiveEmbed=function(a){a=a.find(this.selector.videoEl).target[0];e.stop(a);e.dispose(a);b(a).removeAttr("tabindex")};d.prototype.activeLayer=function(a){var c=a.find(this.selector.videoEl).target[0];e.init(c);this.activeVideo=this.videoLayer;b(c).attr("tabindex",0);setTimeout(function(){b(c).focus()},
500)};d.prototype.deActiveLayer=function(a){a=a.find(this.selector.videoEl).target[0];e.dispose(a);b(a).removeAttr("tabindex")};d.prototype.focusLock=function(a){if(a.keyCode===h.keyCode.TAB_KEY){var c=this.activeVideo.find(".video"),b=this.activeVideo.find(".flagship-full-bleed__close");!1===a.shiftKey&&b.target[0]===document.activeElement?(a.preventDefault(),c.focus()):!0===a.shiftKey&&c.target[0]===document.activeElement&&(a.preventDefault(),b.focus())}};d.prototype.bindEvents=function(){var a=
this;this.videoBtn.target.forEach(function(c){b(c).off("click").on("click",function(){a.videoLayer.show();a.videoWrap.addClass(a.selector.videoActive);a.activeLayer(a.videoWrap);setTimeout(function(){k(a.activeVideo.target[0])},500);f.hiddenScroll();a.ele.window.off("keydown",a.handler.focusLock).on("keydown",a.handler.focusLock)})});this.videoClose.target.forEach(function(c){b(c).off("click").on("click",function(){a.videoBtn.focus();a.videoLayer.hide();a.videoWrap.removeClass(a.selector.videoActive);
a.deActiveLayer(a.videoWrap);l();f.visibleScroll();a.ele.window.off("keydown",a.handler.focusLock)})});0!==this.mediaBox.target.length&&(this.setSubProperty(),this.videoMediaBtn.target.forEach(function(c){b(c).off("click").on("click",function(){a.videoMediaWrap.show();a.activeEmbed(a.videoMediaWrap);a.videoMediaBtn.hide()})}),this.videoMediaClose.target.forEach(function(c){b(c).off("click").on("click",function(){a.videoMediaBtn.show();setTimeout(function(){a.videoMediaBtn.focus()},500);a.videoMediaWrap.hide();
a.deActiveEmbed(a.videoMediaWrap)})}))};var g=function(){b(".flagship-full-bleed").target.length&&b(".flagship-full-bleed").target.forEach(function(a){d.instances.has(a)||new d(a)})};d.instances=new WeakMap;b.ready(g);window.sg.components.flagshipFullBleed={init:g,reInit:function(){b(".flagship-full-bleed").target.forEach(function(a){d.instances.has(a)&&d.instances.get(a).reInit()})}}})();