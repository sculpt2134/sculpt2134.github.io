(function(){function k(){c(f.section).target.forEach(function(b){new d(b)})}var l=window.sg.common.libs,c=window.sg.common.$q,g=window.sg.common.scrollbar,e=window.sg.common.utils,h=window.sg.common.constants.BREAKPOINTS,m=window.sg.common.utils.setMobileFocusLoop,n=window.sg.common.utils.removeMobileFocusLoop,f={section:".pop-up-card"},d=function(b){var a=this;this.selector={section:f.section,openCta:".pop-up-card__icon-wrap",popup:".pop-up-card__layer-popup",popupInner:".scrollbar__contents",popupFocusTarget:".layer-popup__headline-text",
popupBox:".pop-up-card__box-wrap",closeCta:".pop-up-card__layer-close",scrollBar:".scrollbar",activeClass:"is-active",focusClass:"is-focus"};this.ele={window:c(window),section:c(b),openCta:null,popup:null,closeCta:null};this.innerResize=this.activePopup=this.activeIndex=this.activeBtn=null;this.handler={eventFocusLock:function(b){b.keyCode===l.keyCode.TAB_KEY&&(!1===b.shiftKey&&a.activePopup.find(a.selector.closeCta).target[0]===document.activeElement?(b.preventDefault(),a.activePopup.find(a.selector.popupFocusTarget).focus()):
!0===b.shiftKey&&a.activePopup.find(a.selector.popupFocusTarget).target[0]===document.activeElement&&(b.preventDefault(),a.activePopup.find(a.selector.closeCta).focus()))},openPopup:function(b){a.activeBtn=b.currentTarget;a.activeIndex=a.activeBtn.getAttribute("data-popup-match");a.activePopup=c('[data-popup-index\x3d"'+a.activeIndex+'"]');a.activePopup.addClass(a.selector.activeClass);a.activePopup.show();a.activePopup.on("keydown",a.handler.eventFocusLock);setTimeout(function(){a.activePopup.find(a.selector.popupFocusTarget).focus()},
300);e.hiddenScroll();a.handler.setPopup();a.lastHeight=a.activePopup.find(a.selector.popupInner).height();a.innerResize=setInterval(function(){a.newHeight=a.activePopup.find(a.selector.popupInner).height();a.lastHeight!==a.newHeight&&(a.handler.setPopup(),a.lastHeight=a.newHeight)},200);m(a.activePopup.target[0])},closePopup:function(){a.activePopup.removeClass(a.selector.activeClass);a.activePopup.hide();a.activePopup.off("keydown",a.handler.eventFocusLock);c(a.activeBtn).focus();e.visibleScroll();
clearInterval(a.innerResize);a.activeBtn=null;a.activeIndex=null;a.activePopup=null;a.innerResize=null;n()},resize:function(){a.activePopup&&a.handler.setPopup();h.MOBILE>=e.getViewPort().width?!1===a.mobileFlag&&(a.mobileFlag=!0,a.desktopFlag=!1,a.ele.section.hasClass("pop-up-card--use-mouseover")&&(a.ele.popupBox.removeClass(a.selector.focusClass),a.ele.openCta.off("mouseenter"),a.ele.openCta.off("focus"),a.ele.openCta.off("mouseleave"),a.ele.openCta.off("blur"))):!1===a.desktopFlag&&(a.desktopFlag=
!0,a.mobileFlag=!1,a.ele.section.hasClass("pop-up-card--use-mouseover")&&(a.ele.openCta.off("mouseenter").on("mouseenter",function(b){c(b.currentTarget).closest(a.selector.popupBox).addClass(a.selector.focusClass)}),a.ele.openCta.off("focus").on("focus",function(b){c(b.currentTarget).closest(a.selector.popupBox).addClass(a.selector.focusClass)}),a.ele.openCta.off("mouseleave").on("mouseleave",function(b){document.activeElement!==b.currentTarget&&c(b.currentTarget).closest(a.selector.popupBox).removeClass(a.selector.focusClass)}),
a.ele.openCta.off("blur").on("blur",function(b){c(b.currentTarget).closest(a.selector.popupBox).removeClass(a.selector.focusClass)}),c(document.activeElement).hasClass("pop-up-card__icon-wrap")&&c(document.activeElement).closest(a.selector.popupBox).addClass(a.selector.focusClass)))},setPopup:function(){setTimeout(function(){g.resize(a.activePopup.find(a.selector.scrollBar).target[0])},300)}};d.instances.set(b,this);this.init()};d.prototype.init=function(){this.setProperty();this.bindEvents()};d.prototype.reInit=
function(){this.setProperty();this.bindEvents()};d.prototype.setProperty=function(){this.ele.openCta=this.ele.section.find(this.selector.openCta);this.ele.closeCta=this.ele.section.find(this.selector.closeCta);this.ele.popup=this.ele.section.find(this.selector.popup);this.ele.popupBox=this.ele.section.find(this.selector.popupBox);for(var b=0;b<document.querySelectorAll(this.selector.openCta).length;b++)document.querySelectorAll(this.selector.openCta)[b].setAttribute("data-popup-match",b),document.querySelectorAll(this.selector.popup)[b].setAttribute("data-popup-index",
b);h.MOBILE<e.getViewPort().width?(this.desktopFlag=!0,this.mobileFlag=!1):(this.desktopFlag=!1,this.mobileFlag=!0)};d.prototype.bindEvents=function(){var b=this;this.ele.openCta.off("click",this.handler.openPopup).on("click",this.handler.openPopup);this.ele.closeCta.off("click",this.handler.closePopup).on("click",this.handler.closePopup);this.ele.window.off("resize",this.handler.resize).on("resize",this.handler.resize);h.MOBILE<e.getViewPort().width&&this.ele.section.hasClass("pop-up-card--use-mouseover")&&
(this.ele.openCta.off("mouseenter").on("mouseenter",function(a){c(a.currentTarget).closest(b.selector.popupBox).addClass(b.selector.focusClass)}),this.ele.openCta.off("focus").on("focus",function(a){c(a.currentTarget).closest(b.selector.popupBox).addClass(b.selector.focusClass)}),this.ele.openCta.off("mouseleave").on("mouseleave",function(a){document.activeElement!==a.currentTarget&&c(a.currentTarget).closest(b.selector.popupBox).removeClass(b.selector.focusClass)}),this.ele.openCta.off("blur").on("blur",
function(a){c(a.currentTarget).closest(b.selector.popupBox).removeClass(b.selector.focusClass)}))};d.prototype.scrollResize=function(){null!==this.activePopup?g.resize(this.activePopup.find(this.selector.scrollBar).target[0]):document.querySelectorAll(".pop-up-card__layer-popup .scrollbar").forEach(function(b){g.resize(b)})};d.instances=new WeakMap;window.sg.components.popUpCard={init:k,reInit:function(){c(f.section).target.forEach(function(b){d.instances.has(b)?d.instances.get(b).reInit():new d(b)})},
scrollResize:function(){c(f.section).target.forEach(function(b){d.instances.get(b).scrollResize()})}};c.ready(k)})();